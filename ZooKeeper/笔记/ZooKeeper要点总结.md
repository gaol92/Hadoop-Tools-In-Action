### 框架学习方法
- 应用场景
- 工作机制、工作流程
- 内部的组成、角色
- 如何使用：配置、开发程序
- 更深层次：内部的细节原理

### 1、ZooKeeper应用场景
- 1、场景一：服务器状态的动态感知
    - 问题一：假如亚信侧的某台数据采集服务器宕了，那么这台数据采集服务器访问的诺西侧的那台FTP服务器中的数据就没有被及时采集掉；即便那台FTP服务器可存储几天的数据，但这台数据采集服务器恢复后，不仅要下载实时的新数据，还要补充下载在它宕了的这段时间内的旧数据，那么这台数据采集服务器的负载就很大，有可能就追不上进度了。
    - 解决方法：使用一个第三方的软件。所有的数据采集服务器一启动就先到这个第三方软件处注册自己的信息（可以将状态信息也注册上，例如采集到哪个时间点采集到哪个目录了，每隔一段时间更新一下状态），由第三方软件保管这些数据采集服务器的数据，并且提供监听父节点的功能，一旦有哪台数据采集服务器挂了，就以事件通知的方式通知其它存活的数据采集服务器，这样这些存活的采集服务器就能知道是谁挂了，并且选举出让谁去接替挂了的采集服务器的工作。
    - 图示：  
    ![image](https://wx2.sinaimg.cn/mw690/006CX93ply1fve3dg06dpj30x00gg76m.jpg)
### 2、ZooKeeper是什么？
- Zookeeper是一个**分布式协调服务**，就是为用户的分布式应用程序提供协调服务。
    - zookeeper是为别的分布式程序服务的
    - Zookeeper本身就是一个分布式程序（*只要有半数以上节点存活，zk就能正常服务*）
    - Zookeeper所提供的服务涵盖：主从协调、服务器节点动态上下线感知、统一配置管理、**分布式共享锁**、统一名称服务……
- 虽然说可以提供各种服务，但是zookeeper在底层其实只提供了两个功能：
    - 管理(存储，读取)用户程序提交的状态数据（元数据），而非业务数据；
    - 并为用户程序提供数据节点监听服务。
### 3、ZooKeeper集群结构
- 刚开始时，ZooKeeper中的节点之间都是对等的，并没有主次之分，而ZooKeeper集群的主次节点之分是利用一个投票协议PAXOS的简化版Zab实现的。
- 当客户端连接到ZooKeeper集群的任意follower时，follower都会将接收到的来自client的数据传送给zk集群中的leader，leader拿到数据后就会让zk集群中的所有follower节点去更新数据，这样整个zk集群中的数据一致性就保证了。（**实际上数据一致性的保证机制是十分复杂的**）
- 假如zk集群中的节点数目比较庞大，那么zk集群中的leader在传送数据给其它节点时就会有时间上的延迟，所以对于数据更新频繁且要求无延迟的场景，zookeeper是不适用的。
- ZooKeeper集群搭建：参看`E:\hadoop视频\day03\day03\03_大数据基础课_第03天（zookeeper）.docx`